#!/usr/bin/env python

import sys
import argparse
import zhtext
import collections

parser = argparse.ArgumentParser(description='Print the distinct words occuring in a chinese text along with the count of each word.')
parser.add_argument('file', metavar='FILE', type=argparse.FileType('r'), help='text file to process')

args = parser.parse_args()
text = args.file.read().decode('utf-8')

text_parts = zhtext.split_hanzi_nonhanzi(text)
dictionary = zhtext.read_dictionary()
frequencies = zhtext.read_frequencies(dictionary, text_parts)

counter = collections.Counter()
for word in zhtext.get_words(zhtext.segment(dictionary, frequencies, text_parts)):
    counter[word] += 1

for word, count in counter.most_common():
    sys.stdout.write(("%s %d\n" % (word, count)).encode('utf-8'))
